(function(){"use strict";var t={8347:function(t,e,o){var n=o(9242),r=o(3396);function a(t,e,o,n,a,s){const i=(0,r.up)("MainLayout");return(0,r.wg)(),(0,r.j4)(i)}const s=t=>((0,r.dD)("data-v-5cc674d8"),t=t(),(0,r.Cn)(),t),i={class:"main-layout"},l={class:"main-layout__controls-wrapper"},c=s((()=>(0,r._)("span",{class:"main-layout__btn-text"},"Добавить новый лифт",-1))),d=[c],u=s((()=>(0,r._)("span",{class:"main-layout__btn-text"},"Добавить новый этаж",-1))),f=[u],v=s((()=>(0,r._)("span",{class:"main-layout__btn-text"},"Очистить store и localStorage",-1))),h=[v],p={class:"main-layout__wrapper"},x={class:"main-layout__shaft-container"},_={class:"main-layout__floors"};function m(t,e,o,n,a,s){const c=(0,r.up)("AppShaft"),u=(0,r.up)("AppFloor");return(0,r.wg)(),(0,r.iD)("div",i,[(0,r._)("div",l,[(0,r._)("button",{class:"main-layout__btn main-layout__btn-slide-down",onClick:e[0]||(e[0]=(...t)=>s.addShaft&&s.addShaft(...t))},d),(0,r._)("button",{class:"main-layout__btn main-layout__btn-slide-up",onClick:e[1]||(e[1]=(...t)=>s.addFloor&&s.addFloor(...t))},f),(0,r._)("button",{class:"main-layout__btn main-layout__btn--border",onClick:e[2]||(e[2]=(...t)=>s.clearStore&&s.clearStore(...t))},h)]),(0,r._)("div",p,[(0,r._)("div",x,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.$store.state.shafts,(t=>((0,r.wg)(),(0,r.j4)(c,{key:t.index,shaftIndex:t.index,currentFloorIndex:t.currentFloorIndex,nextFloorIndex:t.nextFloorIndex,position:t.position},null,8,["shaftIndex","currentFloorIndex","nextFloorIndex","position"])))),128))]),(0,r._)("div",_,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.$store.state.floors,(t=>((0,r.wg)(),(0,r.j4)(u,{key:t.index,floorIndex:t.index,isActive:t.isActive},null,8,["floorIndex","isActive"])))),128))])])])}var g=o(7139);const F=(0,r.Uk)(" ↑ "),I=(0,r.Uk)(" ↓ ");function b(t,e,o,n,a,s){return(0,r.wg)(),(0,r.iD)("div",{class:(0,g.C_)(["shaft",{"shaft--pending":s.shaft.state===a.ElevatorState.Pending}]),style:(0,g.j5)({height:100*s.floorsCount+"px"})},[(0,r._)("div",{class:"shaft__elevator",style:(0,g.j5)({transform:`translateY(${o.position}px`})},[(0,r._)("div",{class:(0,g.C_)(["shaft__elevator-content",{"shaft__elevator-content--hidden":s.shaft.state===a.ElevatorState.Free}])},[s.shaft.nextFloorIndex>s.shaft.currentFloorIndex?((0,r.wg)(),(0,r.iD)(r.HY,{key:0},[F],64)):((0,r.wg)(),(0,r.iD)(r.HY,{key:1},[I],64)),(0,r.Uk)(" "+(0,g.zw)(s.shaft.nextFloorIndex)+" этаж ",1)],2)],4)],6)}var y;o(1703);(function(t){t[t["Free"]=0]="Free",t[t["Moving"]=1]="Moving",t[t["Pending"]=2]="Pending"})(y||(y={}));var S={props:{shaftIndex:Number,currentFloorIndex:Number,nextFloorIndex:Number,position:Number},data(){return{ElevatorState:y}},created(){switch(this.shaft.state){case y.Moving:this.$store.dispatch("moveElevator",{elevator:this.shaft,nextFloorIndex:this.shaft.nextFloorIndex});break;case y.Pending:this.$store.dispatch("stopElevator",{elevator:this.shaft});break;case y.Free:break;default:throw new Error(`state ${this.shaft.state} doesn't exist`)}},methods:{},computed:{floorsCount(){return this.$store.state.floorsCount},shaft(){return this.$store.state.shafts[this.shaftIndex]}}},w=o(89);const E=(0,w.Z)(S,[["render",b],["__scopeId","data-v-1ff92eaa"]]);var k=E;const C={class:"floor"},O={class:"floor__index"};function j(t,e,o,n,a,s){return(0,r.wg)(),(0,r.iD)("div",C,[(0,r._)("span",O,(0,g.zw)(o.floorIndex),1),(0,r._)("div",{class:(0,g.C_)(["floor__button",{"floor__button--active":o.isActive}]),onClick:e[0]||(e[0]=(...t)=>s.callElevator&&s.callElevator(...t))},null,2)])}var P={props:{floorIndex:Number,isActive:Boolean},data(){return{}},methods:{callElevator(){this.$store.dispatch("callElevator",{nextFloorIndex:this.floorIndex})}}};const $=(0,w.Z)(P,[["render",j],["__scopeId","data-v-47cb81ce"]]);var A=$,M={data(){return{}},components:{AppShaft:k,AppFloor:A},methods:{addFloor(){this.$store.commit("addFloor")},addShaft(){this.$store.commit("addShaft")},clearStore(){this.$store.dispatch("clearStore")}}};const D=(0,w.Z)(M,[["render",m],["__scopeId","data-v-5cc674d8"]]);var N=D,Y={components:{MainLayout:N}};const H=(0,w.Z)(Y,[["render",a]]);var T=H,Z=o(65),U=o(2590),z=o.n(U);const J=7,K=4,L=1,B=3e3,q=10,G=(0,Z.MT)({state:R(),getters:{},mutations:{initialiseStore(t){localStorage.getItem("store")&&this.replaceState(Object.assign(t,JSON.parse(localStorage.getItem("store"))))},updateElevatorPosition(t,{elevator:e}){e.position=e.nextFloorIndex>e.currentFloorIndex?e.position-1:e.position+1},startPendingElevator(t,{elevator:e}){e.state=y.Pending,t.floors.find((t=>t.index===e.nextFloorIndex)).isActive=!1},stopPendingElevator(t,{elevator:e}){e.state=y.Free,e.currentFloorIndex=e.nextFloorIndex},addFloor(t){t.floorsCount+=1,t.floors.unshift(W(t.floorsCount))},addShaft(t){t.shafts.push(V(t.shafts.length))},clearStore(t){Object.assign(t,R()),localStorage.clear()}},actions:{callElevator(t,{nextFloorIndex:e}){const o=t.state.shafts.some((t=>t.nextFloorIndex===e));if(o)return;t.state.floors.find((t=>t.index===e)).isActive=!0;const n=X(e,t.state.shafts);n?t.dispatch("moveElevator",{elevator:n,nextFloorIndex:e}):t.state.pendingFloors.push(e)},moveElevator({dispatch:t,commit:e},{elevator:o,nextFloorIndex:n}){o.nextFloorIndex=n,o.state=y.Moving;const r=tt(n),a=setInterval((()=>{if(r===o.position)return clearInterval(a),e("startPendingElevator",{elevator:o}),void t("stopElevator",{elevator:o});e("updateElevatorPosition",{elevator:o})}),q)},stopElevator({commit:t,state:e,dispatch:o},{elevator:n}){setTimeout((()=>{t("stopPendingElevator",{elevator:n});const r=e.pendingFloors.shift();r&&o("callElevator",{nextFloorIndex:r})}),B)},clearStore({commit:t}){t("clearStore")}},modules:{}});G.subscribe(((t,e)=>{localStorage.setItem("store",JSON.stringify(e))}));var Q=G;function R(){return{shafts:z()(K).map(((t,e)=>V(e))),floorsCount:J,floors:z()(J).map((t=>W(J-t))),pendingFloors:[]}}function V(t){return{index:t,state:y.Free,currentFloorIndex:L,nextFloorIndex:L,position:tt(L)}}function W(t){return{index:t,isActive:!1}}function X(t,e){const o=e.filter((t=>t.state===y.Free));return o.length?o.reduce(((e,o)=>Math.abs(o.currentFloorIndex-t)<Math.abs(e.currentFloorIndex-t)?o:e)):null}function tt(t){return 100*-(t-1)}(0,n.ri)({extends:T,beforeCreate(){this.$store.commit("initialiseStore")}}).use(Q).mount("#app")}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,o),a.exports}o.m=t,function(){var t=[];o.O=function(e,n,r,a){if(!n){var s=1/0;for(d=0;d<t.length;d++){n=t[d][0],r=t[d][1],a=t[d][2];for(var i=!0,l=0;l<n.length;l++)(!1&a||s>=a)&&Object.keys(o.O).every((function(t){return o.O[t](n[l])}))?n.splice(l--,1):(i=!1,a<s&&(s=a));if(i){t.splice(d--,1);var c=r();void 0!==c&&(e=c)}}return e}a=a||0;for(var d=t.length;d>0&&t[d-1][2]>a;d--)t[d]=t[d-1];t[d]=[n,r,a]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,n){var r,a,s=n[0],i=n[1],l=n[2],c=0;if(s.some((function(e){return 0!==t[e]}))){for(r in i)o.o(i,r)&&(o.m[r]=i[r]);if(l)var d=l(o)}for(e&&e(n);c<s.length;c++)a=s[c],o.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return o.O(d)},n=self["webpackChunkelevator"]=self["webpackChunkelevator"]||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var n=o.O(void 0,[998],(function(){return o(8347)}));n=o.O(n)})();
//# sourceMappingURL=app.328b0819.js.map